意向锁

InnoDB支持多种粒度锁定，允许行锁和表锁并存。例如，诸如的语句 在指定表上LOCK TABLES ... WRITE采用排他锁（X锁）。为了使在多个粒度级别上的锁定变得切实可行，请InnoDB使用 意图锁定。意向锁是表级锁，指示事务稍后对表中的行需要哪种类型的锁（共享锁或排他锁）。有两种类型的意图锁：

- 意图共享锁（IS）指示一个事务打算设置一个共享 上各个行锁定在表中。

- 意图独占锁（IX）指示一个事务打算设定各行的排他锁在表中。

意向锁定协议如下：

在事务可以获取表中某行上的共享锁之前，它必须首先获取IS该表上的锁或更高级别的锁。

在事务可以获取表中某行的排它锁之前，它必须首先获取IX 该表中的锁。

|X|IX|S|IS|
|---|---|---|---|
X|冲突|冲突|冲突|冲突
IX|冲突|兼容的|冲突|兼容的
S|冲突|冲突|兼容的|兼容的
IS|冲突|兼容的|兼容的|兼容的